<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadoras Pedi√°tricas</title>

  <!-- Bibliotecas e Fontes -->
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- PWA Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <style>
    :root {
      --primary: rgb(40,90,129);
      --secondary: rgb(185,224,229);
      --emergency: #d32f2f;
      --cardio: #c0392b;
      --lab: #16a085;
      --renal: #2980b9;
      --check: #27ae60;
      --bg: #f4f7f9;
      --text: #2c3e50;
      --white: #ffffff;
      --shadow: 0 4px 15px rgba(0,0,0,0.08);
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { font-family: 'Inter', 'Arial', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; }
    h1, h2, h3 { font-family: 'Comfortaa', cursive; text-align: center; color: var(--primary); }

    header {
      background: var(--white); padding: 28px 20px 16px; text-align: center;
      box-shadow: var(--shadow); border-bottom: 3px solid var(--primary);
    }

    nav {
      position: sticky; top: 0; z-index: 1000; background: var(--primary);
      display: flex; overflow-x: auto; padding: 5px; scrollbar-width: none;
    }
    nav::-webkit-scrollbar { display: none; }
    .nav-btn {
      background: none; border: none; color: rgba(255,255,255,0.7);
      padding: 12px 18px; font-size: 0.75rem; font-weight: 700;
      white-space: nowrap; cursor: pointer; text-transform: uppercase;
    }
    .nav-btn.active { color: var(--white); border-bottom: 3px solid var(--white); }

    .container { padding: 18px; max-width: 780px; margin: 0 auto; padding-bottom: 110px; }
    .tab-content { display: none; animation: fadeIn 0.25s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    .card {
      background: var(--white); border-radius: 15px; padding: 18px;
      margin-bottom: 18px; box-shadow: var(--shadow); border: 1px solid rgba(0,0,0,0.03);
    }
    .card-header {
      border-left: 5px solid var(--primary); padding-left: 12px; margin-bottom: 12px; text-align: left;
    }
    .card-header h2 { text-align: left; margin: 0; font-size: 1.05rem; }

    label { display: block; font-size: 0.8rem; font-weight: 800; margin-top: 10px; color: var(--primary); }
    input, select, textarea {
      width: 100%; padding: 12px; border-radius: 8px;
      border: 1px solid #dce4ec; background: rgb(185,224,229); font-size: 16px; color: var(--text);
    }

    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }

    button.calc-btn {
      width: 100%; padding: 14px; border-radius: 10px; border: none;
      background: var(--primary); color: white; font-weight: 800;
      cursor: pointer; margin-top: 14px; font-family: 'Comfortaa';
    }
    button.calc-btn:active { transform: scale(0.98); opacity: 0.92; }

    .result-box {
      margin-top: 14px; padding: 14px; border-radius: 10px;
      background: var(--secondary); border: 1px solid rgba(40,90,129,0.2);
      display: none; font-size: 0.9rem; line-height: 1.6; white-space: pre-line;
    }
    .destaque { font-weight: 900; color: var(--primary); }
    .muted { color: #6b7b87; font-size: 0.78rem; margin-top: 8px; line-height: 1.3; }
    .warn { color: #8a2b2b; font-weight: 800; }

    table { width: 100%; border-collapse: collapse; margin-top: 12px; font-size: 0.8rem; }
    th { background: var(--primary); color: white; padding: 8px; }
    td { border: 1px solid #eee; padding: 8px; text-align: center; }
    tr:nth-child(even) { background: #f9f9f9; }

    footer { text-align: center; padding: 30px 18px; color: #7f8c8d; font-size: 0.75rem; border-top: 1px solid #eee; }
  </style>
</head>

<body>
  <header>
    <h1>Calculadoras Pedi√°tricas</h1>
    <div class="muted">Neonato ‚Ä¢ Crescimento ‚Ä¢ Cardio ‚Ä¢ Emerg√™ncia ‚Ä¢ Hidrata√ß√£o ‚Ä¢ Laborat√≥rios ‚Ä¢ Checklist</div>
  </header>

  <nav>
    <button class="nav-btn active" onclick="openTab('tab-neo', this)">Neonato</button>
    <button class="nav-btn" onclick="openTab('tab-cresc', this)">Crescimento</button>
    <button class="nav-btn" onclick="openTab('tab-cardio', this)">Cardio</button>
    <button class="nav-btn" onclick="openTab('tab-emerg', this)">Emerg√™ncia</button>
    <button class="nav-btn" onclick="openTab('tab-hidra', this)">Hidrata√ß√£o</button>
    <button class="nav-btn" onclick="openTab('tab-lab', this)">Laborat√≥rios</button>
    <button class="nav-btn" onclick="openTab('tab-check', this)">Checklist</button>
  </nav>

  <div class="container">

    <!-- ========================= -->
    <!-- ABA NEONATOLOGIA (ORDEM) -->
    <!-- ========================= -->
    <div id="tab-neo" class="tab-content active">

      <!-- 1) Idade Gestacional e DPP (ok) -->
      <div class="card">
        <div class="card-header"><h2>Idade Gestacional e DPP</h2></div>

        <label>Modo de Entrada</label>
        <select id="neo-modo" onchange="toggleNeoInput()">
          <option value="dum">DUM (Data √öltima Menstrua√ß√£o)</option>
          <option value="usg">USG 1¬∫ Trimestre</option>
        </select>

        <div id="box-dum">
          <label>Data da DUM</label>
          <input type="date" id="neo-dum">
        </div>

        <div id="box-usg" style="display:none">
          <label>Data do USG</label>
          <input type="date" id="neo-usg-data">
          <div class="grid-2">
            <div>
              <label>Semanas no USG</label>
              <input type="number" id="neo-usg-sem" min="0" step="1">
            </div>
            <div>
              <label>Dias no USG</label>
              <input type="number" id="neo-usg-dias" min="0" max="6" step="1">
            </div>
          </div>
        </div>

        <label>Data para c√°lculo (ex.: data do parto)</label>
        <input type="date" id="neo-ig-calc">

        <button class="calc-btn" onclick="calcNeoIG()">Calcular IG e DPP</button>
        <div id="res-neo-ig" class="result-box"></div>
      </div>

      <!-- 2) IG Corrigida P√≥s-Nascimento (inserir) -->
      <div class="card">
        <div class="card-header"><h2>Idade Gestacional Corrigida P√≥s-Nascimento</h2></div>

        <div class="grid-2">
          <div>
            <label>IG ao nascimento (semanas)</label>
            <input type="number" id="neo-ig-nasc-sem" min="0" step="1">
          </div>
          <div>
            <label>IG ao nascimento (dias)</label>
            <input type="number" id="neo-ig-nasc-dias" min="0" max="6" step="1">
          </div>
        </div>

        <div class="grid-2">
          <div>
            <label>Data de nascimento</label>
            <input type="date" id="neo-data-nasc">
          </div>
          <div>
            <label>Data para c√°lculo</label>
            <input type="date" id="neo-data-posnatal">
          </div>
        </div>

        <button class="calc-btn" onclick="calcIGCorrigidaPosNatal()">Calcular Corrigida P√≥s-Natal</button>
        <div id="res-neo-igcorr" class="result-box"></div>

        <div class="muted">
          L√≥gica: soma o tempo p√≥s-natal (dias) √† IG ao nascimento e retorna <span class="destaque">semanas + dias</span>.
        </div>
      </div>

      <!-- 3) Avalia√ß√£o de peso para IG (PIG/AIG/GIG) (inserir) -->
     <div class="card">
 <div class="card-header"><h2>Peso para Idade Gestacional (INTERGROWTH‚Äë21st)</h2></div>
       
  <div class="grid-2">
    <label>Sexo</label>
<select id="neo-ig-sexo">
  <option value="M">Masculino</option>
  <option value="F">Feminino</option>
</select>
    <div>
      <label>IG ao nascer (semanas)</label>
      <input type="number" id="neo-lub-ig-sem" min="24" max="44" step="1">
    </div>
    <div>
      <label>IG ao nascer (dias)</label>
      <input type="number" id="neo-lub-ig-dias" min="0" max="6" step="1">
    </div>
  </div>

  <label>Peso ao nascer (g)</label>
  <input type="number" id="neo-lub-peso" min="200" step="1">
       
<label>Sexo</label>
<select id="neo-ig-sexo">
  <option value="M">Masculino</option>
  <option value="F">Feminino</option>
</select>
       
 <button class="calc-btn" onclick="calcIntergrowthPIG()">Classificar (PIG/AIG/GIG)</button>
<div id="res-neo-lub" class="result-box"></div>

  <div class="muted warn">
    ATUALIZAR_CONFORME_LUBCHENCO: cole a tabela P10/P90 por semana em <span class="destaque">LUBCHENCO_UNISEX_P10_P90</span>.
  </div>
</div>

      <!-- 4) Icter√≠cia neonatal (ajustar p/ SBP) -->
      <div class="card">
        <div class="card-header"><h2>Icter√≠cia Neonatal (par√¢metros SBP)</h2></div>

        <div class="grid-2">
          <div><label>IG (semanas)</label><input type="number" id="ict-ig" min="24" step="1"></div>
          <div><label>Horas de vida</label><input type="number" id="ict-horas" min="0" step="1"></div>
        </div>

        <label>Bilirrubina Total (mg/dL)</label>
        <input type="number" id="ict-bt" step="0.1" min="0">

        <label>Fatores de risco (marque os presentes)</label>
<div style="margin-top:8px">
  <label style="font-weight:600;color:#2c3e50"><input type="checkbox" class="ict-risk" value="hemolise"> Hem√≥lise (ABO/Rh, Coombs +, G6PD, etc.)</label>
  <label style="font-weight:600;color:#2c3e50"><input type="checkbox" class="ict-risk" value="sepse"> Sepse/instabilidade cl√≠nica</label>
  <label style="font-weight:600;color:#2c3e50"><input type="checkbox" class="ict-risk" value="prematuro"> Prematuridade/idade gestacional lim√≠trofe</label>
  <label style="font-weight:600;color:#2c3e50"><input type="checkbox" class="ict-risk" value="albumina"> Hipoalbuminemia (se aplic√°vel)</label>
</div>

        <button class="calc-btn" onclick="calcIctericiaSBP2021()">Avaliar Conduta</button>
        <div id="res-ict" class="result-box"></div>

        <div class="muted warn">
          ATUALIZAR_CONFORME_SBP: este bloco est√° pronto para receber os limiares/tabelas SBP (fototerapia/exsangu√≠neo) por IG e horas de vida.
        </div>
      </div>

    </div>

    <!-- ========================= -->
    <!-- ABA CRESCIMENTO (ORDEM)  -->
    <!-- ========================= -->
    <div id="tab-cresc" class="tab-content">

      <!-- 1) Bloco √∫nico: velocidades (PC, peso/dia, estatura) -->
      <div class="card">
        <div class="card-header"><h2>Velocidades (PC, Peso, Estatura) ‚Äî bloco √∫nico</h2></div>

        <div class="grid-2">
          <div><label>Data inicial</label><input type="date" id="cr-data-i"></div>
          <div><label>Data final</label><input type="date" id="cr-data-f"></div>
        </div>

        <div class="grid-3">
          <div>
            <label>PC inicial (cm)</label>
            <input type="number" id="cr-pc-i" step="0.1">
          </div>
          <div>
            <label>PC final (cm)</label>
            <input type="number" id="cr-pc-f" step="0.1">
          </div>
          <div>
            <label>Idade (meses) (p/ refer√™ncia)</label>
            <input type="number" id="cr-idade-meses" step="0.1" min="0">
          </div>
        </div>

        <div class="grid-2">
          <div>
            <label>Peso inicial</label>
            <input type="number" id="cr-peso-i" step="1">
          </div>
          <div>
            <label>Peso final</label>
            <input type="number" id="cr-peso-f" step="1">
          </div>
        </div>

        <label>Unidade do peso</label>
        <select id="cr-peso-unid">
          <option value="g">g</option>
          <option value="kg">kg</option>
        </select>

        <div class="grid-2">
          <div>
            <label>Estatura inicial (cm)</label>
            <input type="number" id="cr-alt-i" step="0.1">
          </div>
          <div>
            <label>Estatura final (cm)</label>
            <input type="number" id="cr-alt-f" step="0.1">
          </div>
        </div>

        <button class="calc-btn" onclick="calcVelocidadesCrescimento()">Calcular velocidades</button>

        <div id="res-cr-peso" class="result-box"></div>
        <div id="res-cr-pc" class="result-box"></div>
        <div id="res-cr-alt" class="result-box"></div>

        <div id="ref-cr" class="result-box"></div>
      </div>

      <!-- 2) Alvo parental + idade √≥ssea + an√°lise -->
      <div class="card">
        <div class="card-header"><h2>Alvo parental + Idade √≥ssea + An√°lise integrada</h2></div>

        <div class="grid-2">
          <div><label>Altura do pai (cm)</label><input type="number" id="ap-pai" step="0.1"></div>
          <div><label>Altura da m√£e (cm)</label><input type="number" id="ap-mae" step="0.1"></div>
        </div>

        <label>Sexo da crian√ßa</label>
        <select id="ap-sexo">
          <option value="M">Masculino</option>
          <option value="F">Feminino</option>
        </select>

        <div class="grid-2">
          <div><label>Altura atual (cm)</label><input type="number" id="ap-alt-atual" step="0.1"></div>
          <div><label>Idade cronol√≥gica (anos)</label><input type="number" id="ap-idade" step="0.1"></div>
        </div>

        <label>Idade √≥ssea (anos) (entrada manual)</label>
        <input type="number" id="ap-io" step="0.1">

        <button class="calc-btn" onclick="calcAlvoParentalEAnalise()">Calcular e analisar</button>
        <div id="res-ap" class="result-box"></div>

        <div class="muted">
          ‚ö†Ô∏è Idade √≥ssea aqui √© **input cl√≠nico** (ex.: Greulich & Pyle). A interpreta√ß√£o avan√ßada fica como placeholder para voc√™ definir regra.
        </div>
      </div>

    </div>

    <!-- ========================= -->
    <!-- ABA CARDIO (ORDEM)       -->
    <!-- ========================= -->
    <div id="tab-cardio" class="tab-content">

      <!-- 1) Avalia√ß√£o de ECG -->
      <div class="card">
        <div class="card-header" style="border-color:var(--cardio)"><h2>Avalia√ß√£o de ECG</h2></div>

        <p class="muted">Use quadradinhos: 1mm = 0,04s (25 mm/s). Se preferir, informe RR em quadradinhos.</p>

        <div class="grid-2">
          <div><label>QT (quadradinhos)</label><input type="number" id="ecg-qt-q" step="1" min="1"></div>
          <div><label>RR (quadradinhos)</label><input type="number" id="ecg-rr-q" step="1" min="1"></div>
        </div>

        <button class="calc-btn" style="background:var(--cardio)" onclick="calcECG()">Analisar ECG (QTc + FC)</button>
        <div id="res-ecg" class="result-box"></div>

        <div class="muted warn">
          Intervalos/eixo por idade: placeholder (n√£o inserir tabela sem fonte). Estrutura pronta para voc√™ preencher.
        </div>
      </div>

      <!-- 2) Classifica√ß√£o PA pediatria e adulto -->
      <div class="card">
        <div class="card-header" style="border-color:var(--cardio)"><h2>Classifica√ß√£o de Press√£o Arterial (Pediatria e Adulto)</h2></div>

        <div class="grid-2">
          <div><label>PAS (mmHg)</label><input type="number" id="pa-pas" step="1"></div>
          <div><label>PAD (mmHg)</label><input type="number" id="pa-pad" step="1"></div>
        </div>

        <div class="grid-2">
          <div><label>Idade (anos)</label><input type="number" id="pa-idade" step="0.1"></div>
          <div>
            <label>Sexo</label>
            <select id="pa-sexo">
              <option value="M">Masculino</option>
              <option value="F">Feminino</option>
            </select>
          </div>
        </div>

        <label>Estatura (cm) ou Percentil de estatura (se voc√™ j√° tiver)</label>
        <input type="number" id="pa-estatura" step="0.1">

        <button class="calc-btn" style="background:var(--cardio)" onclick="classificarPA()">Classificar PA</button>
        <div id="res-pa" class="result-box"></div>

        <div class="muted warn">
          Pediatria (SBP): precisa de **tabela percent√≠lica por idade/sexo/estatura**. O c√≥digo est√° preparado para plugar.
        </div>
      </div>

    </div>

    <!-- ========================= -->
    <!-- ABA EMERG√äNCIA (ORDEM)   -->
    <!-- ========================= -->
    <div id="tab-emerg" class="tab-content">

      <div class="card">
        <div class="card-header" style="border-color:var(--emergency)"><h2>Dados do paciente (base)</h2></div>
        <div class="grid-2">
          <div><label>Peso (kg)</label><input type="number" id="em-peso" step="0.1" min="0"></div>
          <div><label>Idade (anos)</label><input type="number" id="em-idade" step="0.1" min="0"></div>
        </div>
        <div class="muted">Os subitens abaixo usam este peso/idade como fonte √∫nica (reduz erro operacional).</div>
      </div>

      <!-- 4.1 PCR e p√≥s PCR -->
      <div class="card">
        <div class="card-header" style="border-color:var(--emergency)"><h2>4.1 PCR e P√≥s-PCR</h2></div>

        <label>Subitem</label>
        <select id="em-41">
          <option value="rcp">Ressuscita√ß√£o Cardiopulmonar</option>
          <option value="sri">Sequ√™ncia R√°pida de Intuba√ß√£o</option>
          <option value="tubo">Tamanho do tubo e posi√ß√£o de fixa√ß√£o</option>
        </select>

        <button class="calc-btn" style="background:var(--emergency)" onclick="calcEmerg41()">Gerar</button>
        <div id="res-em-41" class="result-box"></div>

        <div class="muted warn">Doses e limites: prontos para voc√™ ajustar conforme protocolo institucional/AHA/SBP (sem inventar).</div>
      </div>

      <!-- 4.2 Seda√ß√£o e analgesia -->
      <div class="card">
        <div class="card-header" style="border-color:var(--emergency)"><h2>4.2 Seda√ß√£o e analgesia</h2></div>

        <label>Subitem</label>
        <select id="em-42">
          <option value="proced">Para procedimentos</option>
          <option value="cont">Cont√≠nua</option>
        </select>

        <button class="calc-btn" style="background:var(--emergency)" onclick="calcEmerg42()">Gerar</button>
        <div id="res-em-42" class="result-box"></div>
      </div>

      <!-- 4.3 Urg√™ncias neurol√≥gicas -->
      <div class="card">
        <div class="card-header" style="border-color:var(--emergency)"><h2>4.3 Urg√™ncias neurol√≥gicas</h2></div>

        <label>Subitem</label>
        <select id="em-43">
          <option value="crise">Crise convulsiva</option>
          <option value="status">Status convulsivo</option>
          <option value="hic">Hipertens√£o intracraniana</option>
        </select>

        <button class="calc-btn" style="background:var(--emergency)" onclick="calcEmerg43()">Gerar</button>
        <div id="res-em-43" class="result-box"></div>
      </div>

      <!-- 4.4 Dist√∫rbio de ritmos -->
      <div class="card">
        <div class="card-header" style="border-color:var(--emergency)"><h2>4.4 Dist√∫rbio de ritmos</h2></div>

        <label>Subitem</label>
        <select id="em-44">
          <option value="chocaveis">Choc√°veis (tipos de ritmo e dose)</option>
          <option value="nao">N√£o choc√°veis (tipos, medicamentos e doses)</option>
        </select>

        <button class="calc-btn" style="background:var(--emergency)" onclick="calcEmerg44()">Gerar</button>
        <div id="res-em-44" class="result-box"></div>
      </div>

      <!-- 4.5 Choques -->
      <div class="card">
        <div class="card-header" style="border-color:var(--emergency)"><h2>4.5 Choques (tipos, medicamentos e doses)</h2></div>

        <label>Tipo de choque</label>
        <select id="em-45">
          <option value="hipov">Hipovol√™mico</option>
          <option value="sept">S√©ptico</option>
          <option value="ana">Anafil√°tico</option>
          <option value="card">Cardiog√™nico</option>
        </select>

        <button class="calc-btn" style="background:var(--emergency)" onclick="calcEmerg45()">Gerar</button>
        <div id="res-em-45" class="result-box"></div>
      </div>
    </div>

    <!-- ========================= -->
    <!-- ABA HIDRATA√á√ÉO (ORDEM)   -->
    <!-- ========================= -->
    <div id="tab-hidra" class="tab-content">

      <!-- Holliday-Segar -->
      <div class="card">
        <div class="card-header" style="border-color:var(--renal)"><h2>Holliday-Segar (com eletr√≥litos)</h2></div>

        <label>Peso (kg)</label>
        <input type="number" id="hs-peso" step="0.1" min="0">

        <label>Modo eletr√≥litos</label>
        <select id="hs-modo">
          <option value="meqkg">mEq/kg/dia</option>
          <option value="meql">mEq/L (solu√ß√£o final)</option>
        </select>

        <div class="grid-2">
          <div><label>Na+</label><input type="number" id="hs-na" step="0.1"></div>
          <div><label>K+</label><input type="number" id="hs-k" step="0.1"></div>
        </div>
        <div class="grid-2">
          <div><label>Cl-</label><input type="number" id="hs-cl" step="0.1"></div>
          <div><label>Glicose (g/L ou g/kg/dia)</label><input type="number" id="hs-glic" step="0.1"></div>
        </div>

        <button class="calc-btn" style="background:var(--renal)" onclick="calcHollidaySegar()">Calcular manuten√ß√£o</button>
        <div id="res-hs" class="result-box"></div>
      </div>

      <!-- VIG -->
      <div class="card">
        <div class="card-header" style="border-color:var(--renal)"><h2>VIG (com eletr√≥litos)</h2></div>

        <div class="grid-2">
          <div><label>Peso (kg)</label><input type="number" id="vig-peso" step="0.1" min="0"></div>
          <div><label>VIG alvo (mL/kg/h)</label><input type="number" id="vig-alvo" step="0.1" value="4"></div>
        </div>

        <div class="grid-2">
          <div><label>Na+ (mEq/L)</label><input type="number" id="vig-na" step="0.1"></div>
          <div><label>K+ (mEq/L)</label><input type="number" id="vig-k" step="0.1"></div>
        </div>
        <div class="grid-2">
          <div><label>Cl- (mEq/L)</label><input type="number" id="vig-cl" step="0.1"></div>
          <div><label>Glicose (g/L)</label><input type="number" id="vig-glic" step="0.1"></div>
        </div>

        <button class="calc-btn" style="background:var(--renal)" onclick="calcVIG()">Calcular VIG</button>
        <div id="res-vig" class="result-box"></div>
      </div>

      <!-- Schwartz (ok) -->
      <div class="card">
        <div class="card-header" style="border-color:var(--renal)"><h2>Clearance de Schwartz (eTFG)</h2></div>
        <div class="grid-2">
          <div><label>Creatinina (mg/dL)</label><input type="number" id="ren-cr" step="0.01"></div>
          <div><label>Estatura (cm)</label><input type="number" id="ren-alt" step="0.1"></div>
        </div>
        <button class="calc-btn" style="background:var(--renal)" onclick="calcSchwartz()">Calcular eTFG</button>
        <div id="res-renal" class="result-box"></div>
      </div>
    </div>

    <!-- ========================= -->
    <!-- ABA LABORAT√ìRIOS (ORDEM) -->
    <!-- ========================= -->
    <div id="tab-lab" class="tab-content">

      <!-- Gasometria com conduta -->
      <div class="card">
        <div class="card-header" style="border-color:var(--lab)"><h2>Gasometria (an√°lise + conduta)</h2></div>

        <div class="grid-2">
          <div><label>pH</label><input type="number" id="g-ph" step="0.01"></div>
          <div><label>pCO2 (mmHg)</label><input type="number" id="g-pco2" step="0.1"></div>
        </div>

        <div class="grid-2">
          <div><label>HCO3- (mEq/L)</label><input type="number" id="g-hco3" step="0.1"></div>
          <div><label>Na+ (mEq/L)</label><input type="number" id="g-na" step="0.1"></div>
        </div>

        <div class="grid-2">
          <div><label>Cl- (mEq/L)</label><input type="number" id="g-cl" step="0.1"></div>
          <div><label>Albumina (g/dL) (opcional)</label><input type="number" id="g-alb" step="0.1"></div>
        </div>

        <button class="calc-btn" style="background:var(--lab)" onclick="calcGasoConduta()">Analisar</button>
        <div id="res-gaso" class="result-box"></div>

        <div class="muted warn">Condutas s√£o orientativas. Ajuste conforme contexto cl√≠nico e protocolos locais.</div>
      </div>

      <!-- Convers√£o de unidades (ok) -->
      <div class="card">
        <div class="card-header" style="border-color:var(--lab)"><h2>Conversor de Unidades</h2></div>
        <select id="lab-conv">
          <option value="0.2495">C√°lcio (mg/dL -> mmol/L)</option>
          <option value="88.4">Creatinina (mg/dL -> umol/L)</option>
          <option value="17.1">Bilirrubina (mg/dL -> umol/L)</option>
        </select>
        <input type="number" id="lab-val" placeholder="Valor convencional" style="margin-top:10px">
        <button class="calc-btn" style="background:var(--lab)" onclick="convertLab()">Converter</button>
        <div id="res-lab" class="result-box"></div>
      </div>
    </div>

    <!-- ========================= -->
    <!-- ABA CHECKLIST            -->
    <!-- ========================= -->
    <div id="tab-check" class="tab-content">
      <div class="card">
        <div class="card-header" style="border-color:var(--check)"><h2>Puericultura Inteligente</h2></div>
        <label>Idade da Consulta</label>
        <select id="ck-idade" onchange="renderCheck()">
          <option value="">Selecione...</option>
          <option value="2">2 Meses</option>
          <option value="6">6 Meses</option>
          <option value="12">12 Meses</option>
        </select>
        <div id="check-area" style="margin-top:15px"></div>
      </div>
    </div>

    <!-- BIBLIOGRAFIA -->
    <div class="card">
      <h3 style="font-size:0.9rem">Bibliografia de Refer√™ncia</h3>
      <ul style="font-size:0.75rem; color:#7f8c8d; padding-left:15px">
        <li>SBP - Diretrizes (inserir vers√£o/ano conforme uso)</li>
        <li>OMS - Growth Standards (2006)</li>
        <li>AHA - PALS Guidelines (ajustar vers√£o conforme protocolo)</li>
        <li>Schwartz GJ, et al. (2009)</li>
      </ul>
    </div>

  </div>

  <footer>Vers√£o de trabalho ‚Ä¢ Estruturas prontas para atualiza√ß√£o conforme SBP/SBC ‚Ä¢ Offline-friendly</footer>

  <script>
    // =========================
    // UTILIT√ÅRIOS
    // =========================
    function openTab(tabId, btnEl) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
      btnEl.classList.add('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function showResult(elId, text) {
      const el = document.getElementById(elId);
      el.style.display = 'block';
      el.textContent = text;
    }

    function showResultHTML(elId, text) {
      const el = document.getElementById(elId);
      el.style.display = 'block';
      el.innerHTML = text;
    }

    function parseDate(v) {
      if (!v) return null;
      const d = new Date(v + "T00:00:00");
      return isNaN(d.getTime()) ? null : d;
    }

    function diffDays(d1, d2) {
      return Math.floor((d2.getTime() - d1.getTime()) / (1000 * 60 * 60 * 24));
    }

    function weeksDaysFromTotalDays(totalDays) {
      const w = Math.floor(totalDays / 7);
      const d = totalDays % 7;
      return { w, d };
    }

    function clamp(n, min, max) { return Math.min(Math.max(n, min), max); }

    // =========================
    // 1) NEONATO
    // =========================
    function toggleNeoInput() {
      const modo = document.getElementById('neo-modo').value;
      document.getElementById('box-dum').style.display = (modo === 'dum') ? 'block' : 'none';
      document.getElementById('box-usg').style.display = (modo === 'usg') ? 'block' : 'none';
    }

    function calcNeoIG() {
      const modo = document.getElementById('neo-modo').value;
      const dataCalc = parseDate(document.getElementById('neo-ig-calc').value);
      if (!dataCalc) return showResult('res-neo-ig', 'Informe a data para c√°lculo.');

      let dpp = null;
      let igDias = null;

      if (modo === 'dum') {
        const dum = parseDate(document.getElementById('neo-dum').value);
        if (!dum) return showResult('res-neo-ig', 'Informe a data da DUM.');

        igDias = diffDays(dum, dataCalc);
        dpp = new Date(dum.getTime());
        dpp.setDate(dpp.getDate() + 280);
      } else {
        const usgData = parseDate(document.getElementById('neo-usg-data').value);
        const sem = Number(document.getElementById('neo-usg-sem').value);
        const dias = Number(document.getElementById('neo-usg-dias').value);

        if (!usgData) return showResult('res-neo-ig', 'Informe a data do USG.');
        if (!Number.isFinite(sem) || sem < 0) return showResult('res-neo-ig', 'Informe semanas do USG.');
        if (!Number.isFinite(dias) || dias < 0 || dias > 6) return showResult('res-neo-ig', 'Dias do USG deve estar entre 0 e 6.');

        // DUM estimada = dataUSG - (sem*7 + dias)
        const gestDaysAtUSG = (sem * 7) + dias;
        const dumEst = new Date(usgData.getTime());
        dumEst.setDate(dumEst.getDate() - gestDaysAtUSG);

        igDias = diffDays(dumEst, dataCalc);
        dpp = new Date(dumEst.getTime());
        dpp.setDate(dpp.getDate() + 280);
      }

      if (igDias < 0) return showResult('res-neo-ig', 'A data para c√°lculo √© anterior ao in√≠cio da gesta√ß√£o estimado.');

      const wd = weeksDaysFromTotalDays(igDias);
      const msg =
        `IG na data informada: ${wd.w} semanas e ${wd.d} dias\n` +
        `DPP estimada: ${dpp.toLocaleDateString('pt-BR')}`;
      showResult('res-neo-ig', msg);
    }

    function calcIGCorrigidaPosNatal() {
      const sem = Number(document.getElementById('neo-ig-nasc-sem').value);
      const dias = Number(document.getElementById('neo-ig-nasc-dias').value);
      const dn = parseDate(document.getElementById('neo-data-nasc').value);
      const dc = parseDate(document.getElementById('neo-data-posnatal').value);

      if (!Number.isFinite(sem) || sem < 0) return showResult('res-neo-igcorr', 'Informe IG ao nascimento (semanas).');
      if (!Number.isFinite(dias) || dias < 0 || dias > 6) return showResult('res-neo-igcorr', 'Dias ao nascimento deve estar entre 0 e 6.');
      if (!dn) return showResult('res-neo-igcorr', 'Informe a data de nascimento.');
      if (!dc) return showResult('res-neo-igcorr', 'Informe a data para c√°lculo.');

      const posDays = diffDays(dn, dc);
      if (posDays < 0) return showResult('res-neo-igcorr', 'Data para c√°lculo n√£o pode ser anterior ao nascimento.');

      const igTotalDays = (sem * 7) + dias + posDays;
      const wd = weeksDaysFromTotalDays(igTotalDays);

      showResult('res-neo-igcorr', `IG corrigida: ${wd.w} semanas e ${wd.d} dias\nTempo p√≥s-natal considerado: ${posDays} dia(s)`);
    }

// =========================
// INTERGROWTH‚Äë21st ‚Äî PIG/AIG/GIG (P10/P90)
// Entrada: IG (sem+dias) + peso (g) + sexo (M/F)
// Tabelas: P10/P90 em kg (vindas do Excel)
// =========================

const INTERGROWTH_P10_P90 = {
  boys:  { veryPreterm: {}, newborn: {} },
  girls: { veryPreterm: {}, newborn: {} }
};

// üîß Aqui entram os dados (vou te entregar em blocos extra√≠dos das planilhas)
// Exemplo de linha:
// INTERGROWTH_P10_P90.girls.veryPreterm["33+0"] = { p10: 1.41, p90: 2.35 };
    // Dados reais ‚Äî INTERGROWTH Very‚ÄëPreterm Peso (Meninas) ‚Äî P10/P90 (kg)

    (function(){
  const GA=["33+0","33+1","33+2","33+3","33+4","33+5","33+6","34+0","34+1","34+2","34+3","34+4","34+5","34+6","35+0","35+1","35+2","35+3","35+4","35+5","35+6","36+0","36+1","36+2","36+3","36+4","36+5","36+6","37+0","37+1","37+2","37+3","37+4","37+5","37+6","38+0","38+1","38+2","38+3","38+4","38+5","38+6","39+0","39+1","39+2","39+3","39+4","39+5","39+6","40+0","40+1","40+2","40+3","40+4","40+5","40+6","41+0","41+1","41+2","41+3","41+4","41+5","41+6","42+0","42+1","42+2","42+3","42+4","42+5","42+6"];
  const P10=[1.43,1.47,1.51,1.55,1.59,1.63,1.67,1.71,1.74,1.78,1.82,1.85,1.89,1.92,1.95,1.99,2.02,2.05,2.09,2.12,2.15,2.18,2.21,2.24,2.27,2.30,2.33,2.36,2.38,2.41,2.44,2.47,2.49,2.52,2.54,2.57,2.59,2.62,2.64,2.67,2.69,2.71,2.73,2.76,2.78,2.80,2.82,2.84,2.86,2.88,2.90,2.92,2.94,2.96,2.98,2.99,3.01,3.03,3.05,3.06,3.08,3.09,3.11,3.12,3.14,3.15,3.17,3.18,3.20,3.21];
  const P90=[2.52,2.56,2.60,2.64,2.67,2.71,2.75,2.79,2.82,2.86,2.89,2.93,2.96,3.00,3.03,3.06,3.09,3.13,3.16,3.19,3.22,3.25,3.28,3.31,3.34,3.37,3.39,3.42,3.45,3.48,3.50,3.53,3.55,3.58,3.61,3.63,3.65,3.68,3.70,3.72,3.75,3.77,3.79,3.81,3.83,3.86,3.88,3.90,3.92,3.94,3.95,3.97,3.99,4.01,4.03,4.04,4.06,4.08,4.09,4.11,4.13,4.14,4.16,4.17,4.19,4.20,4.21,4.23,4.24,4.25];
  for (let i=0;i<GA.length;i++) INTERGROWTH_P10_P90.boys.newborn[GA[i]]={p10:P10[i],p90:P90[i]};
})();
    (function(){
  const GA=["24+0","24+1","24+2","24+3","24+4","24+5","24+6","25+0","25+1","25+2","25+3","25+4","25+5","25+6","26+0","26+1","26+2","26+3","26+4","26+5","26+6","27+0","27+1","27+2","27+3","27+4","27+5","27+6","28+0","28+1","28+2","28+3","28+4","28+5","28+6","29+0","29+1","29+2","29+3","29+4","29+5","29+6","30+0","30+1","30+2","30+3","30+4","30+5","30+6","31+0","31+1","31+2","31+3","31+4","31+5","31+6","32+0","32+1","32+2","32+3","32+4","32+5","32+6"];
  const P10=[0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.63,0.64,0.65,0.66,0.67,0.69,0.7,0.71,0.72,0.74,0.75,0.77,0.78,0.79,0.81,0.82,0.84,0.85,0.87,0.88,0.9,0.92,0.93,0.95,0.97,0.98,1,1.02,1.03,1.05,1.07,1.09,1.11,1.13,1.15,1.17,1.19,1.21,1.23,1.25,1.27,1.29,1.31,1.34,1.36,1.38,1.41,1.43,1.45,1.48,1.5];
  const P90=[0.82,0.83,0.85,0.87,0.88,0.9,0.92,0.93,0.95,0.97,0.99,1.01,1.03,1.04,1.06,1.08,1.1,1.13,1.15,1.17,1.19,1.21,1.23,1.26,1.28,1.3,1.33,1.35,1.37,1.4,1.42,1.45,1.48,1.5,1.53,1.56,1.58,1.61,1.64,1.67,1.7,1.73,1.76,1.79,1.82,1.85,1.88,1.92,1.95,1.98,2.02,2.05,2.09,2.12,2.16,2.19,2.23,2.27,2.31,2.35,2.38,2.42,2.46];
  for (let i=0;i<GA.length;i++) INTERGROWTH_P10_P90.boys.veryPreterm[GA[i]]={p10:P10[i],p90:P90[i]};
})();
    (function(){
  const GA=["24+0","24+1","24+2","24+3","24+4","24+5","24+6","25+0","25+1","25+2","25+3","25+4","25+5","25+6","26+0","26+1","26+2","26+3","26+4","26+5","26+6","27+0","27+1","27+2","27+3","27+4","27+5","27+6","28+0","28+1","28+2","28+3","28+4","28+5","28+6","29+0","29+1","29+2","29+3","29+4","29+5","29+6","30+0","30+1","30+2","30+3","30+4","30+5","30+6","31+0","31+1","31+2","31+3","31+4","31+5","31+6","32+0","32+1","32+2","32+3","32+4","32+5","32+6"];
  const P10=[0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.64,0.65,0.66,0.67,0.68,0.7,0.71,0.72,0.74,0.75,0.76,0.78,0.79,0.81,0.82,0.83,0.85,0.86,0.88,0.9,0.91,0.93,0.94,0.96,0.98,0.99,1.01,1.03,1.05,1.07,1.08,1.1,1.12,1.14,1.16,1.18,1.2,1.22,1.24,1.26,1.28,1.31,1.33,1.35,1.37,1.4,1.42];
  const P90=[0.77,0.79,0.8,0.82,0.83,0.85,0.87,0.88,0.9,0.92,0.93,0.95,0.97,0.99,1.01,1.02,1.04,1.06,1.08,1.1,1.12,1.14,1.16,1.19,1.21,1.23,1.25,1.27,1.3,1.32,1.34,1.37,1.39,1.42,1.44,1.47,1.5,1.52,1.55,1.58,1.6,1.63,1.66,1.69,1.72,1.75,1.78,1.81,1.84,1.87,1.9,1.94,1.97,2,2.04,2.07,2.11,2.14,2.18,2.21,2.25,2.29,2.33];
  for (let i=0;i<GA.length;i++) INTERGROWTH_P10_P90.girls.veryPreterm[GA[i]]={p10:P10[i],p90:P90[i]};
})();
    (function(){
  const GA=["36+0","36+1","36+2","36+3","36+4","36+5","36+6","37+0","37+1","37+2","37+3","37+4","37+5","37+6","38+0","38+1","38+2","38+3","38+4","38+5","38+6","39+0","39+1","39+2","39+3","39+4","39+5","39+6","40+0","40+1","40+2","40+3","40+4","40+5","40+6","41+0","41+1","41+2","41+3","41+4","41+5","41+6","42+0","42+1","42+2","42+3","42+4","42+5","42+6"];
  const P10=[2.14,2.17,2.20,2.23,2.25,2.28,2.31,2.33,2.36,2.38,2.41,2.43,2.46,2.48,2.50,2.53,2.55,2.57,2.59,2.61,2.63,2.65,2.67,2.69,2.71,2.73,2.74,2.76,2.78,2.80,2.81,2.83,2.84,2.86,2.87,2.89,2.90,2.91,2.93,2.94,2.95,2.96,2.98,2.99,3.00,3.01,3.02,3.03,3.04];
  const P90=[3.12,3.15,3.18,3.21,3.24,3.27,3.30,3.32,3.35,3.38,3.40,3.43,3.46,3.48,3.51,3.53,3.55,3.58,3.60,3.62,3.64,3.66,3.68,3.70,3.72,3.74,3.76,3.78,3.80,3.82,3.84,3.85,3.87,3.89,3.90,3.92,3.93,3.95,3.96,3.97,3.99,4.00,4.01,4.03,4.04,4.05,4.06,4.07,4.08];
  for (let i=0;i<GA.length;i++) INTERGROWTH_P10_P90.girls.newborn[GA[i]]={p10:P10[i],p90:P90[i]};
})();
    

function igKey(sem, dias) { return `${sem}+${dias}`; }

function pickIntergrowthDomain(sem, dias) {
  const totalDays = (sem * 7) + dias;
  const d24 = (24 * 7);
  const d33 = (33 * 7);
  const d42_6 = (42 * 7) + 6;

  if (totalDays < d24 || totalDays > d42_6) return { error: 'IG fora do intervalo INTERGROWTH (24+0 a 42+6).' };
  return { domain: (totalDays < d33) ? 'veryPreterm' : 'newborn' };
}

function classifyPIG_AIG_GIG(pesoG, p10Kg, p90Kg) {
  const pesoKg = pesoG / 1000;
  if (pesoKg < p10Kg) return 'PIG';
  if (pesoKg > p90Kg) return 'GIG';
  return 'AIG';
}

function calcIntergrowthPIG() {
  const sexo = document.getElementById('neo-ig-sexo').value; // M/F
  const igSem = Number(document.getElementById('neo-lub-ig-sem').value);
  const igDias = Number(document.getElementById('neo-lub-ig-dias').value);
  const pesoG = Number(document.getElementById('neo-lub-peso').value);

  if (!Number.isFinite(igSem) || igSem <= 0) return showResult('res-neo-lub', 'Informe IG (semanas).');
  if (!Number.isFinite(igDias) || igDias < 0 || igDias > 6) return showResult('res-neo-lub', 'Dias deve estar entre 0 e 6.');
  if (!Number.isFinite(pesoG) || pesoG <= 0) return showResult('res-neo-lub', 'Informe peso ao nascer (g).');

  const key = igKey(igSem, igDias);
  const pick = pickIntergrowthDomain(igSem, igDias);
  if (pick.error) return showResult('res-neo-lub', pick.error);

  const sexKey = (sexo === 'M') ? 'boys' : 'girls';
  const row = INTERGROWTH_P10_P90[sexKey][pick.domain][key];

  if (!row) {
    return showResult(
      'res-neo-lub',
      `Sem dados INTERGROWTH carregados para ${sexo === 'M' ? 'meninos' : 'meninas'} (${pick.domain}) na IG ${key}.\n` +
      `Vou precisar inserir/colar o bloco de tabela correspondente do Excel para essa faixa.`
    );
  }

  const cls = classifyPIG_AIG_GIG(pesoG, row.p10, row.p90);

  const msg =
    `INTERGROWTH‚Äë21st (${sexo === 'M' ? 'Meninos' : 'Meninas'} ‚Ä¢ ${pick.domain === 'veryPreterm' ? 'Very‚ÄëPreterm' : 'Newborn'})\n` +
    `IG: ${key}\nPeso: ${pesoG} g (${(pesoG/1000).toFixed(3)} kg)\n\n` +
    `P10: ${row.p10.toFixed(2)} kg (${Math.round(row.p10*1000)} g)\n` +
    `P90: ${row.p90.toFixed(2)} kg (${Math.round(row.p90*1000)} g)\n\n` +
    `Classifica√ß√£o: ${cls}`;

  showResult('res-neo-lub', msg);
}
// =========================
// ICTER√çCIA ‚Äî SBP 2021 (completo)
// =========================

// RN &lt;35 semanas: SBP 2021 - Tabela 10 (BT mg/dL)
// Regra SBP: "Aplicar os valores inferiores referidos" quando houver fatores de risco.
// Aqui implementado como: se risco => usa o LIMITE INFERIOR do intervalo; se sem risco => LIMITE SUPERIOR.
const SBP2021_PRE35 = [
  { minGA: 0,     maxGA: 27.999, photo: [5, 6],  exch: [11, 14] },
  { minGA: 28.0,  maxGA: 29.999, photo: [6, 8],  exch: [12, 14] },
  { minGA: 30.0,  maxGA: 31.999, photo: [8, 10], exch: [13, 16] },
  { minGA: 32.0,  maxGA: 33.999, photo: [10,12], exch: [15, 18] },
  { minGA: 34.0,  maxGA: 34.999, photo: [10,12], exch: [17, 19] }
];

function getRiskFlagIctericia() {
  const checks = Array.from(document.querySelectorAll('.ict-risk'));
  return checks.some(c => c.checked);
}

function pickThreshold(range, hasRisk) {
  // range = [min,max]
  // SBP diz aplicar valores inferiores quando risco presente.
  return hasRisk ? range[0] : range[1];
}

function findPre35Row(gaFloat) {
  return SBP2021_PRE35.find(r => gaFloat >= r.minGA && gaFloat &lt;= r.maxGA) || null;
}

    // RN ‚â•35 semanas: SBP 2021 (por horas de vida)
// Estrutura para voc√™ plugar os valores exatos do SBP 2021.
// Formato: para cada faixa de IG (35-37 e >=38) e faixa de horas, defina fototerapia e exsangu√≠neo.
// ATUALIZAR_CONFORME_SBP2021: colar valores reais aqui.
const SBP2021_GE35 = {
  groups: [
    {
      name: "35-37",
      minGA: 35,
      maxGA: 37.999,
      rows: [
        // { minH: 0, maxH: 23, photo: X, exch: Y },
        // { minH: 24, maxH: 35, photo: X, exch: Y },
        // ...
      ]
    },
    {
      name: ">=38",
      minGA: 38,
      maxGA: 99,
      rows: [
        // { minH: 0, maxH: 23, photo: X, exch: Y },
        // ...
      ]
    }
  ],
  // Ajuste por risco em RN ‚â•35: SBP usa linha/limiar mais baixo quando risco presente.
  // Voc√™ pode implementar risco como: subtrair delta OU usar uma tabela "com risco".
  // Aqui eu deixo preparado para as duas formas.
  hasRiskTable: false, // se voc√™ colar "rowsRisk", mude para true
};

function findGE35Row(gaFloat, horas) {
  const grp = SBP2021_GE35.groups.find(g => gaFloat >= g.minGA && gaFloat &lt;= g.maxGA);
  if (!grp) return null;
  const row = grp.rows.find(r => horas >= r.minH && horas &lt;= r.maxH);
  return row ? { grp, row } : null;
}

    function calcIctericiaSBP2021() {
  const igSem = Number(document.getElementById('ict-ig').value);
  const horas = Number(document.getElementById('ict-horas').value);
  const bt = Number(document.getElementById('ict-bt').value);

  if (!Number.isFinite(igSem) || igSem &lt;= 0) return showResult('res-ict', 'Informe IG (semanas).');
  if (!Number.isFinite(horas) || horas &lt; 0) return showResult('res-ict', 'Informe horas de vida.');
  if (!Number.isFinite(bt) || bt &lt; 0) return showResult('res-ict', 'Informe bilirrubina total (mg/dL).');

  const hasRisk = getRiskFlagIctericia();
  const gaFloat = igSem; // aqui IG est√° em semanas inteiras; se voc√™ quiser semanas+dias, eu adapto como float.

  // 1) RN &lt;35 semanas: SBP 2021 Tabela 10 (usa IG corrigida)
  if (gaFloat &lt; 35) {
    const row = findPre35Row(gaFloat);
    if (!row) {
      return showResult('res-ict', 'Sem refer√™ncia SBP 2021 (&lt;35 semanas) para esta IG. Verifique o valor informado.');
    }

    const thrPhoto = pickThreshold(row.photo, hasRisk);
    const thrExch = pickThreshold(row.exch, hasRisk);

    let conduta = 'Acompanhar e repetir BT conforme cl√≠nica.';
    if (bt >= thrExch) conduta = 'Exsanguineotransfus√£o: INDICA√á√ÉO (avaliar urg√™ncia, otimizar fototerapia intensiva enquanto prepara).';
    else if (bt >= thrPhoto) conduta = 'Fototerapia: INDICA√á√ÉO (preferir intensiva conforme contexto).';

    const msg =
      `SBP 2021 ‚Äî RN &lt;35 semanas (Tabela 10)\n` +
      `IG: ${igSem} sem | Horas de vida: ${horas}h | Risco: ${hasRisk ? 'Sim (usar limite inferior)' : 'N√£o (usar limite superior)'}\n` +
      `BT: ${bt.toFixed(1)} mg/dL\n\n` +
      `Limiar fototerapia: ${thrPhoto.toFixed(1)} mg/dL\n` +
      `Limiar exsangu√≠neo: ${thrExch.toFixed(1)} mg/dL\n\n` +
      `Conduta: ${conduta}`;

    return showResult('res-ict', msg);
  }

  // 2) RN ‚â•35 semanas: SBP 2021 por horas/IG (precisa tabela preenchida)
  const hit = findGE35Row(gaFloat, horas);
  if (!hit) {
    return showResult(
      'res-ict',
      `SBP 2021 ‚Äî RN ‚â•35 semanas\n` +
      `Tabela por horas/IG ainda n√£o foi preenchida no c√≥digo.\n\n` +
      `Preencha SBP2021_GE35.groups[].rows com os limiares oficiais do SBP 2021.\n` +
      `Depois disso o c√°lculo fica autom√°tico.`
    );
  }

  const thrPhoto = hit.row.photo;
  const thrExch = hit.row.exch;

  let conduta = 'Acompanhar e repetir BT conforme risco cl√≠nico.';
  if (bt >= thrExch) conduta = 'Exsanguineotransfus√£o: INDICA√á√ÉO (avaliar urg√™ncia).';
  else if (bt >= thrPhoto) conduta = 'Fototerapia: INDICA√á√ÉO.';

  const msg =
    `SBP 2021 ‚Äî RN ‚â•35 semanas\n` +
    `Grupo IG: ${hit.grp.name}\n` +
    `Horas: ${horas}h | Risco: ${hasRisk ? 'Sim (implementar ajuste conforme SBP)' : 'N√£o'}\n` +
    `BT: ${bt.toFixed(1)} mg/dL\n\n` +
    `Limiar fototerapia: ${thrPhoto.toFixed(1)} mg/dL\n` +
    `Limiar exsangu√≠neo: ${thrExch.toFixed(1)} mg/dL\n\n` +
    `Conduta: ${conduta}`;

  return showResult('res-ict', msg);
}
        // =========================
    // 2) CRESCIMENTO
    // =========================
    const REF_CRESC = {
      // ATUALIZAR_CONFORME_REFER√äNCIA: placeholders por faixa et√°ria
      peso_g_dia: [
        { minM: 0, maxM: 3, ref: '20‚Äì30 g/dia (placeholder)' },
        { minM: 4, maxM: 6, ref: '20 g/dia (placeholder)' },
        { minM: 7, maxM: 9, ref: '15 g/dia (placeholder)' },
        { minM: 10, maxM: 12, ref: '10 g/dia (placeholder)' }
      ],
      pc_cm_mes: [
        { minM: 0, maxM: 3, ref: '‚âà 2 cm/m√™s (placeholder)' },
        { minM: 4, maxM: 6, ref: '‚âà 1 cm/m√™s (placeholder)' },
        { minM: 7, maxM: 12, ref: '‚âà 0,5 cm/m√™s (placeholder)' }
      ],
      alt_cm_ano: [
        { minM: 0, maxM: 12, ref: '‚âà 25 cm/ano (placeholder)' },
        { minM: 12, maxM: 24, ref: '‚âà 12 cm/ano (placeholder)' },
        { minM: 24, maxM: 48, ref: '‚âà 7‚Äì8 cm/ano (placeholder)' }
      ]
    };

    function pickRef(arr, idadeMeses) {
      const it = arr.find(x => idadeMeses >= x.minM && idadeMeses <= x.maxM);
      return it ? it.ref : 'Sem refer√™ncia configurada para esta idade.';
    }

    function calcVelocidadesCrescimento() {
      const di = parseDate(document.getElementById('cr-data-i').value);
      const df = parseDate(document.getElementById('cr-data-f').value);
      const pc1 = Number(document.getElementById('cr-pc-i').value);
      const pc2 = Number(document.getElementById('cr-pc-f').value);
      const p1 = Number(document.getElementById('cr-peso-i').value);
      const p2 = Number(document.getElementById('cr-peso-f').value);
      const alt1 = Number(document.getElementById('cr-alt-i').value);
      const alt2 = Number(document.getElementById('cr-alt-f').value);
      const un = document.getElementById('cr-peso-unid').value;
      const idadeM = Number(document.getElementById('cr-idade-meses').value);

      if (!di || !df) return showResult('res-cr-peso', 'Informe as datas inicial e final.');
      const days = diffDays(di, df);
      if (days <= 0) return showResult('res-cr-peso', 'A data final deve ser maior que a inicial.');

      // PESO -> g
      if (!Number.isFinite(p1) || !Number.isFinite(p2)) return showResult('res-cr-peso', 'Informe pesos inicial e final.');
      let p1g = (un === 'kg') ? p1 * 1000 : p1;
      let p2g = (un === 'kg') ? p2 * 1000 : p2;
      const ganhoGdia = (p2g - p1g) / days;

      // PC
      if (!Number.isFinite(pc1) || !Number.isFinite(pc2)) return showResult('res-cr-pc', 'Informe PC inicial e final.');
      const months = days / 30.4375;
      const pcCmMes = (pc2 - pc1) / months;
      const pcCmSemana = (pc2 - pc1) / (days / 7);
      const pcCmAno = (pc2 - pc1) / (days / 365.25);

      // ALTURA
      if (!Number.isFinite(alt1) || !Number.isFinite(alt2)) return showResult('res-cr-alt', 'Informe estatura inicial e final.');
      const altCmAno = (alt2 - alt1) / (days / 365.25);

      showResult('res-cr-peso',
        `Ganho ponderal: ${ganhoGdia.toFixed(1)} g/dia\n` +
        `ŒîPeso total: ${(p2g - p1g).toFixed(0)} g em ${days} dia(s)`
      );

      showResult('res-cr-pc',
        `Velocidade de PC:\n` +
        `${pcCmMes.toFixed(2)} cm/m√™s\n` +
        `${pcCmSemana.toFixed(2)} cm/semana\n` +
        `${pcCmAno.toFixed(2)} cm/ano\n` +
        `ŒîPC total: ${(pc2 - pc1).toFixed(2)} cm`
      );

      showResult('res-cr-alt',
        `Velocidade de estatura:\n` +
        `${altCmAno.toFixed(2)} cm/ano\n` +
        `ŒîEstatura total: ${(alt2 - alt1).toFixed(2)} cm`
      );

      const idadeRef = Number.isFinite(idadeM) ? idadeM : null;
      const refPeso = (idadeRef !== null) ? pickRef(REF_CRESC.peso_g_dia, idadeRef) : 'Informe idade (meses) para refer√™ncia.';
      const refPC = (idadeRef !== null) ? pickRef(REF_CRESC.pc_cm_mes, idadeRef) : 'Informe idade (meses) para refer√™ncia.';
      const refAlt = (idadeRef !== null) ? pickRef(REF_CRESC.alt_cm_ano, idadeRef) : 'Informe idade (meses) para refer√™ncia.';

      showResult('ref-cr',
        `Refer√™ncias (placeholders):\n` +
        `Peso (g/dia): ${refPeso}\n` +
        `PC (cm/m√™s): ${refPC}\n` +
        `Estatura (cm/ano): ${refAlt}\n\n` +
        `ATUALIZAR_CONFORME_REFER√äNCIA: edite REF_CRESC.`
      );
    }

    function calcAlvoParentalEAnalise() {
      const pai = Number(document.getElementById('ap-pai').value);
      const mae = Number(document.getElementById('ap-mae').value);
      const sexo = document.getElementById('ap-sexo').value;
      const altAtual = Number(document.getElementById('ap-alt-atual').value);
      const idade = Number(document.getElementById('ap-idade').value);
      const io = Number(document.getElementById('ap-io').value);

      if (!Number.isFinite(pai) || pai <= 0) return showResult('res-ap', 'Informe altura do pai.');
      if (!Number.isFinite(mae) || mae <= 0) return showResult('res-ap', 'Informe altura da m√£e.');
      if (!Number.isFinite(altAtual) || altAtual <= 0) return showResult('res-ap', 'Informe altura atual.');
      if (!Number.isFinite(idade) || idade < 0) return showResult('res-ap', 'Informe idade cronol√≥gica.');

      const alvo = (sexo === 'M') ? ((pai + mae + 13) / 2) : ((pai + mae - 13) / 2);
      const faixaMin = alvo - 8.5;
      const faixaMax = alvo + 8.5;

      const dentro = (altAtual >= faixaMin && altAtual <= faixaMax);
      const delta = altAtual - alvo;

      let analise = `Alvo parental: ${alvo.toFixed(1)} cm\nFaixa esperada: ${faixaMin.toFixed(1)} a ${faixaMax.toFixed(1)} cm\n\n`;
      analise += `Altura atual: ${altAtual.toFixed(1)} cm\n`;
      analise += `Diferen√ßa vs alvo: ${delta.toFixed(1)} cm\n`;
      analise += `Interpreta√ß√£o: ${dentro ? 'Dentro' : 'Fora'} da faixa alvo.\n`;

      if (Number.isFinite(io) && io > 0) {
        const diffIO = io - idade;
        analise += `\nIdade √≥ssea informada: ${io.toFixed(1)} anos\n`;
        analise += `IO - IC: ${diffIO.toFixed(1)} ano(s)\n`;
        analise += `Interpreta√ß√£o IO: PLACEHOLDER (definir regra e limiares).`;
      } else {
        analise += `\nIdade √≥ssea: n√£o informada (opcional).`;
      }

      showResult('res-ap', analise);
    }

    // =========================
    // 3) CARDIO
    // =========================
    function calcECG() {
      const qtq = Number(document.getElementById('ecg-qt-q').value);
      const rrq = Number(document.getElementById('ecg-rr-q').value);
      if (!Number.isFinite(qtq) || qtq <= 0) return showResult('res-ecg', 'Informe QT (quadradinhos).');
      if (!Number.isFinite(rrq) || rrq <= 0) return showResult('res-ecg', 'Informe RR (quadradinhos).');

      const qt_s = qtq * 0.04;
      const rr_s = rrq * 0.04;

      const qtc_bazett = qt_s / Math.sqrt(rr_s);
      const qtc_fridericia = qt_s / Math.cbrt(rr_s);
      const fc = 1500 / rrq; // 25 mm/s => 1500 quadradinhos/minuto

      const msg =
        `FC estimada: ${fc.toFixed(0)} bpm\n` +
        `QT: ${qt_s.toFixed(3)} s\nRR: ${rr_s.toFixed(3)} s\n\n` +
        `QTc (Bazett): ${(qtc_bazett * 1000).toFixed(0)} ms\n` +
        `QTc (Fridericia): ${(qtc_fridericia * 1000).toFixed(0)} ms\n\n` +
        `Intervalos por idade/eixo: PLACEHOLDER (inserir tabela).`;

      showResult('res-ecg', msg);
    }

    // Adulto (SBC) ‚Äî l√≥gica num√©rica padr√£o. Pediatria (SBP) ‚Äî placeholder.
    function classificarPA() {
      const pas = Number(document.getElementById('pa-pas').value);
      const pad = Number(document.getElementById('pa-pad').value);
      const idade = Number(document.getElementById('pa-idade').value);
      const sexo = document.getElementById('pa-sexo').value;
      const est = Number(document.getElementById('pa-estatura').value);

      if (!Number.isFinite(pas) || pas <= 0) return showResult('res-pa', 'Informe PAS.');
      if (!Number.isFinite(pad) || pad <= 0) return showResult('res-pa', 'Informe PAD.');
      if (!Number.isFinite(idade) || idade < 0) return showResult('res-pa', 'Informe idade.');
      if (!Number.isFinite(est) || est <= 0) return showResult('res-pa', 'Informe estatura (cm) ou percentil.');

      if (idade >= 18) {
        // Classifica√ß√£o adulta (padr√£o num√©rico; ajustar conforme SBC/atualiza√ß√£o desejada)
        let cls = 'Normal';
        if (pas < 120 && pad < 80) cls = 'Normal';
        else if (pas >= 120 && pas <= 129 && pad < 80) cls = 'PA elevada';
        else if ((pas >= 130 && pas <= 139) || (pad >= 80 && pad <= 89)) cls = 'HAS est√°gio 1';
        else if (pas >= 140 || pad >= 90) cls = 'HAS est√°gio 2';
        if (pas >= 180 || pad >= 120) cls = 'Crise hipertensiva (avaliar urg√™ncia/emerg√™ncia)';

        showResult('res-pa', `Adulto (SBC - num√©rico): ${cls}\nPAS/PAD: ${pas}/${pad} mmHg`);
        return;
      }

      // Pediatria: precisa tabela percent√≠lica.
      const msg =
        `Pediatria (SBP): classifica√ß√£o requer percentis por idade/sexo/estatura.\n\n` +
        `Dados: ${idade} anos | sexo ${sexo} | estatura ${est}\nPAS/PAD: ${pas}/${pad} mmHg\n\n` +
        `ATUALIZAR_CONFORME_SBP: plugar tabela percent√≠lica (P90/P95/P95+12) para gerar classifica√ß√£o (normal, PA elevada, HAS1, HAS2).`;
      showResult('res-pa', msg);
    }

    // =========================
    // 4) EMERG√äNCIA (subitens)
    // =========================
    function getPesoIdadeEmerg() {
      const peso = Number(document.getElementById('em-peso').value);
      const idade = Number(document.getElementById('em-idade').value);
      if (!Number.isFinite(peso) || peso <= 0) return { error: 'Informe peso (kg).' };
      if (!Number.isFinite(idade) || idade < 0) return { error: 'Informe idade (anos).' };
      return { peso, idade };
    }

    // Doses base (placeholders; ajustar conforme seu protocolo)
    const EMERG_DOSES = {
      // ATUALIZAR_CONFORME_PROTOCOLO
      rcp: {
        epi_mgkg: 0.01, // mg/kg IV/IO (exemplo)
        amio_mgkg: 5,   // mg/kg (exemplo)
        lido_mgkg: 1,   // mg/kg (exemplo)
        defib_jkg_1: 2, // J/kg (exemplo)
        defib_jkg_2: 4  // J/kg (exemplo)
      },
      sri: {
        // exemplos para estrutura
        cet_mgkg: 1.5,
        eto_mgkg: 0.3,
        mida_mgkg: 0.1,
        fenta_mcgkg: 2,
        roc_mgkg: 1.2,
        succ_mgkg: 2
      },
      tubo: {
        // F√≥rmulas pedi√°tricas cl√°ssicas
      },
      sedacao: {
        // placeholders
      },
      neuro: {
        // placeholders
      },
      ritmo: {
        // placeholders
      },
      choque: {
        bolus_mlkg: 20 // mL/kg (exemplo)
      }
    };

    function calcEmerg41() {
      const base = getPesoIdadeEmerg();
      if (base.error) return showResult('res-em-41', base.error);

      const { peso, idade } = base;
      const sub = document.getElementById('em-41').value;

      let out = '';
      if (sub === 'rcp') {
        const epi = EMERG_DOSES.rcp.epi_mgkg * peso;
        const amio = EMERG_DOSES.rcp.amio_mgkg * peso;
        const lido = EMERG_DOSES.rcp.lido_mgkg * peso;
        const def1 = EMERG_DOSES.rcp.defib_jkg_1 * peso;
        const def2 = EMERG_DOSES.rcp.defib_jkg_2 * peso;

        out =
          `RCP (placeholder):\n` +
          `‚Ä¢ Epinefrina: ${epi.toFixed(2)} mg (0,01 mg/kg IV/IO)\n` +
          `‚Ä¢ Amiodarona: ${amio.toFixed(0)} mg (5 mg/kg)\n` +
          `‚Ä¢ Lidoca√≠na: ${lido.toFixed(0)} mg (1 mg/kg)\n` +
          `‚Ä¢ Desfibrila√ß√£o: ${def1.toFixed(0)} J (2 J/kg) ‚Üí ${def2.toFixed(0)} J (4 J/kg)\n\n` +
          `ATUALIZAR_CONFORME_PROTOCOLO: revise doses, apresenta√ß√µes e m√°ximos.`;
      }

      if (sub === 'sri') {
        const cet = EMERG_DOSES.sri.cet_mgkg * peso;
        const eto = EMERG_DOSES.sri.eto_mgkg * peso;
        const mida = EMERG_DOSES.sri.mida_mgkg * peso;
        const fenta = EMERG_DOSES.sri.fenta_mcgkg * peso;
        const roc = EMERG_DOSES.sri.roc_mgkg * peso;
        const succ = EMERG_DOSES.sri.succ_mgkg * peso;

        out =
          `SRI (placeholder):\n` +
          `Indu√ß√£o (escolher 1):\n` +
          `‚Ä¢ Cetamina: ${cet.toFixed(1)} mg\n` +
          `‚Ä¢ Etomidato: ${eto.toFixed(1)} mg\n` +
          `‚Ä¢ Midazolam: ${mida.toFixed(1)} mg\n\n` +
          `Analgesia (se indicado):\n` +
          `‚Ä¢ Fentanil: ${fenta.toFixed(0)} mcg\n\n` +
          `Bloqueio neuromuscular (escolher 1):\n` +
          `‚Ä¢ Rocur√¥nio: ${roc.toFixed(1)} mg\n` +
          `‚Ä¢ Succinilcolina: ${succ.toFixed(1)} mg\n\n` +
          `ATUALIZAR_CONFORME_PROTOCOLO: confirme faixas, contraindica√ß√µes, m√°ximos e dilui√ß√µes.`;
      }

      if (sub === 'tubo') {
        // F√≥rmulas: di√¢metro interno (cuffed) = idade/4 + 3.5 ; uncuffed = idade/4 + 4
        // Profundidade (oral) ‚âà 3 x DI (cm) (heur√≠stica)
        // Obs: RN tem tabela por peso/IG (placeholder)
        const diCuffed = (idade / 4) + 3.5;
        const diUncuffed = (idade / 4) + 4.0;
        const profCuffed = 3 * diCuffed;
        const profUncuffed = 3 * diUncuffed;

        out =
          `Tubo e fixa√ß√£o (heur√≠sticas cl√°ssicas):\n` +
          `‚Ä¢ ETT cuffed (DI): idade/4 + 3,5 = ${diCuffed.toFixed(1)} mm\n` +
          `‚Ä¢ ETT uncuffed (DI): idade/4 + 4,0 = ${diUncuffed.toFixed(1)} mm\n` +
          `‚Ä¢ Profundidade oral (aprox): 3 √ó DI\n` +
          `  - cuffed: ~${profCuffed.toFixed(1)} cm\n` +
          `  - uncuffed: ~${profUncuffed.toFixed(1)} cm\n\n` +
          `Neonato: ATUALIZAR_TABELA_RN por peso/IG para DI e profundidade.`;
      }

      showResult('res-em-41', out);
    }

    function calcEmerg42() {
      const base = getPesoIdadeEmerg();
      if (base.error) return showResult('res-em-42', base.error);
      const { peso } = base;
      const sub = document.getElementById('em-42').value;

      let out = '';
      if (sub === 'proced') {
        out =
          `Seda√ß√£o/analgesia para procedimentos (placeholder):\n` +
          `‚Ä¢ Midazolam: X mg/kg ‚Üí ${(peso * 0.1).toFixed(2)} mg (exemplo estrutural)\n` +
          `‚Ä¢ Fentanil: X mcg/kg ‚Üí ${(peso * 2).toFixed(0)} mcg (exemplo estrutural)\n\n` +
          `ATUALIZAR_TABELAS_SEDACAO: inserir drogas, doses, m√°ximos e observa√ß√µes.`;
      } else {
        out =
          `Seda√ß√£o cont√≠nua (placeholder):\n` +
          `‚Ä¢ Midazolam: X mcg/kg/min\n` +
          `‚Ä¢ Fentanil: X mcg/kg/h\n` +
          `‚Ä¢ Dexmedetomidina: X mcg/kg/h\n\n` +
          `ATUALIZAR_TABELAS_SEDACAO: inserir taxas e limites conforme protocolo.`;
      }

      showResult('res-em-42', out);
    }

    function calcEmerg43() {
      const base = getPesoIdadeEmerg();
      if (base.error) return showResult('res-em-43', base.error);
      const { peso } = base;
      const sub = document.getElementById('em-43').value;

      let out = '';
      if (sub === 'crise') {
        out =
          `Crise convulsiva (placeholder):\n` +
          `‚Ä¢ Benzodiazep√≠nico (ex.: diazepam/midazolam): dose por kg\n` +
          `Exemplo estrutural: midazolam 0,2 mg/kg ‚Üí ${(peso * 0.2).toFixed(2)} mg\n\n` +
          `ATUALIZAR_TABELAS_NEURO: definir 1¬™/2¬™ linha, vias, repeti√ß√£o e m√°ximos.`;
      } else if (sub === 'status') {
        out =
          `Status convulsivo (placeholder):\n` +
          `‚Ä¢ 1¬™ linha: benzo\n` +
          `‚Ä¢ 2¬™ linha: levetiracetam/fenito√≠na/valproato (conforme protocolo)\n` +
          `‚Ä¢ 3¬™ linha: considerar UTI/intuba√ß√£o/seda√ß√£o cont√≠nua\n\n` +
          `ATUALIZAR_TABELAS_NEURO: inserir doses e sequ√™ncia temporal.`;
      } else {
        out =
          `Hipertens√£o intracraniana (placeholder):\n` +
          `‚Ä¢ Elevar cabeceira, analgesia/seda√ß√£o, normocapnia, tratar causa\n` +
          `‚Ä¢ Solu√ß√µes hipert√¥nicas/manitol conforme protocolo\n\n` +
          `ATUALIZAR_TABELAS_NEURO: inserir doses e crit√©rios.`;
      }

      showResult('res-em-43', out);
    }

    function calcEmerg44() {
      const base = getPesoIdadeEmerg();
      if (base.error) return showResult('res-em-44', base.error);
      const { peso } = base;
      const sub = document.getElementById('em-44').value;

      let out = '';
      if (sub === 'chocaveis') {
        out =
          `Ritmos choc√°veis (placeholder): FV / TV sem pulso\n` +
          `‚Ä¢ Desfibrila√ß√£o: 2‚Äì4 J/kg (ver 4.1)\n` +
          `‚Ä¢ Antiarr√≠tmico: amiodarona/lidoca√≠na (ver 4.1)\n\n` +
          `Peso: ${peso.toFixed(1)} kg\n` +
          `ATUALIZAR_TABELAS_RITMO: inserir sequ√™ncia e doses conforme guideline.`;
      } else {
        out =
          `Ritmos n√£o choc√°veis (placeholder): AESP / assistolia\n` +
          `‚Ä¢ Epinefrina conforme protocolo\n` +
          `‚Ä¢ Tratar causas revers√≠veis (Hs e Ts)\n\n` +
          `ATUALIZAR_TABELAS_RITMO: inserir medica√ß√µes, doses e checklist.`;
      }

      showResult('res-em-44', out);
    }

    function calcEmerg45() {
      const base = getPesoIdadeEmerg();
      if (base.error) return showResult('res-em-45', base.error);
      const { peso } = base;
      const tipo = document.getElementById('em-45').value;

      const bolus = EMERG_DOSES.choque.bolus_mlkg * peso;

      let out = `Choque (placeholder) ‚Äî tipo: ${tipo}\n\n`;
      out += `‚Ä¢ Cristaloide: ${bolus.toFixed(0)} mL (20 mL/kg) (exemplo)\n`;
      out += `‚Ä¢ Vasopressores/inotr√≥picos: PLACEHOLDER (noradrenalina/adrenalina/dobutamina etc.)\n\n`;
      out += `ATUALIZAR_TABELAS_CHOQUE: inserir drogas, doses por kg, m√°ximos e estrat√©gia por tipo.`;

      showResult('res-em-45', out);
    }

    // =========================
    // 5) HIDRATA√á√ÉO
    // =========================
    function calcHollidaySegar() {
      const peso = Number(document.getElementById('hs-peso').value);
      const modo = document.getElementById('hs-modo').value;

      const na = Number(document.getElementById('hs-na').value);
      const k = Number(document.getElementById('hs-k').value);
      const cl = Number(document.getElementById('hs-cl').value);
      const glic = Number(document.getElementById('hs-glic').value);

      if (!Number.isFinite(peso) || peso <= 0) return showResult('res-hs', 'Informe peso (kg).');

      // Holliday-Segar: 100/50/20 mL/kg/dia
      let vol24 = 0;
      if (peso <= 10) vol24 = 100 * peso;
      else if (peso <= 20) vol24 = 1000 + 50 * (peso - 10);
      else vol24 = 1500 + 20 * (peso - 20);

      const mlh = vol24 / 24;

      let out =
        `Manuten√ß√£o (Holliday-Segar):\n` +
        `Volume 24h: ${vol24.toFixed(0)} mL\n` +
        `Taxa: ${mlh.toFixed(1)} mL/h\n\n`;

      if (modo === 'meqkg') {
        // mEq/kg/dia -> total/dia
        if (Number.isFinite(na)) out += `Na+ total/dia: ${(na * peso).toFixed(1)} mEq\n`;
        if (Number.isFinite(k)) out += `K+ total/dia: ${(k * peso).toFixed(1)} mEq\n`;
        if (Number.isFinite(cl)) out += `Cl- total/dia: ${(cl * peso).toFixed(1)} mEq\n`;
        if (Number.isFinite(glic)) out += `Glicose total/dia: ${(glic * peso).toFixed(1)} g\n`;
        out += `\nObserva√ß√£o: composi√ß√£o final do soro depende do volume e solu√ß√£o-base (placeholder).`;
      } else {
        // mEq/L -> total/dia estimado com base no volume
        const L24 = vol24 / 1000;
        if (Number.isFinite(na)) out += `Na+ estimado/dia: ${(na * L24).toFixed(1)} mEq\n`;
        if (Number.isFinite(k)) out += `K+ estimado/dia: ${(k * L24).toFixed(1)} mEq\n`;
        if (Number.isFinite(cl)) out += `Cl- estimado/dia: ${(cl * L24).toFixed(1)} mEq\n`;
        if (Number.isFinite(glic)) out += `Glicose estimado/dia: ${(glic * L24).toFixed(1)} g\n`;
        out += `\nObserva√ß√£o: isto assume concentra√ß√£o final homog√™nea (placeholder).`;
      }

      showResult('res-hs', out);
    }

    function calcVIG() {
      const peso = Number(document.getElementById('vig-peso').value);
      const alvo = Number(document.getElementById('vig-alvo').value);
      const na = Number(document.getElementById('vig-na').value);
      const k = Number(document.getElementById('vig-k').value);
      const cl = Number(document.getElementById('vig-cl').value);
      const glic = Number(document.getElementById('vig-glic').value);

      if (!Number.isFinite(peso) || peso <= 0) return showResult('res-vig', 'Informe peso (kg).');
      if (!Number.isFinite(alvo) || alvo <= 0) return showResult('res-vig', 'Informe VIG alvo (mL/kg/h).');

      const mlh = alvo * peso;
      const vol24 = mlh * 24;

      let out =
        `VIG:\n` +
        `Taxa: ${mlh.toFixed(1)} mL/h\n` +
        `Volume 24h: ${vol24.toFixed(0)} mL\n\n` +
        `Eletr√≥litos (mEq/L) informados:\n` +
        `Na+: ${Number.isFinite(na) ? na.toFixed(1) : '‚Äî'} | K+: ${Number.isFinite(k) ? k.toFixed(1) : '‚Äî'} | Cl-: ${Number.isFinite(cl) ? cl.toFixed(1) : '‚Äî'}\n` +
        `Glicose (g/L): ${Number.isFinite(glic) ? glic.toFixed(1) : '‚Äî'}\n\n` +
        `ATUALIZAR: definir c√°lculo de prescri√ß√£o final por solu√ß√£o-base e aditivos (placeholder).`;

      showResult('res-vig', out);
    }

    function calcSchwartz() {
      const cr = Number(document.getElementById('ren-cr').value);
      const alt = Number(document.getElementById('ren-alt').value);
      if (!Number.isFinite(cr) || cr <= 0) return showResult('res-renal', 'Informe creatinina.');
      if (!Number.isFinite(alt) || alt <= 0) return showResult('res-renal', 'Informe estatura (cm).');

      const etfg = (0.413 * alt) / cr;
      showResult('res-renal', `eTFG (Schwartz): ${etfg.toFixed(1)} mL/min/1,73m¬≤`);
    }

    // =========================
    // 6) LABORAT√ìRIOS
    // =========================
    function calcGasoConduta() {
      const ph = Number(document.getElementById('g-ph').value);
      const pco2 = Number(document.getElementById('g-pco2').value);
      const hco3 = Number(document.getElementById('g-hco3').value);
      const na = Number(document.getElementById('g-na').value);
      const cl = Number(document.getElementById('g-cl').value);
      const alb = Number(document.getElementById('g-alb').value);

      if (!Number.isFinite(ph) || ph <= 0) return showResult('res-gaso', 'Informe pH.');
      if (!Number.isFinite(pco2) || pco2 <= 0) return showResult('res-gaso', 'Informe pCO2.');
      if (!Number.isFinite(hco3) || hco3 <= 0) return showResult('res-gaso', 'Informe HCO3-.');
      if (!Number.isFinite(na) || na <= 0) return showResult('res-gaso', 'Informe Na+.');
      if (!Number.isFinite(cl) || cl <= 0) return showResult('res-gaso', 'Informe Cl-.');

      const ag = na - (cl + hco3);
      let agCorr = ag;
      let agMsg = `√Çnion gap: ${ag.toFixed(1)}`;

      // Corre√ß√£o por albumina (aproxima√ß√£o comum; ajuste se preferir)
      if (Number.isFinite(alb) && alb > 0) {
        // AGcorr = AG + 2.5*(4 - alb)
        agCorr = ag + 2.5 * (4 - alb);
        agMsg += `\n√Çnion gap corrigido (Alb): ${agCorr.toFixed(1)} (Alb ${alb.toFixed(1)} g/dL)`;
      }

      // Diagn√≥stico prim√°rio b√°sico
      const acidemia = ph < 7.35;
      const alcalemia = ph > 7.45;

      let prim = 'Indeterminado';
      if (acidemia) {
        prim = (hco3 < 22) ? 'Acidose metab√≥lica (prov√°vel)' : 'Acidose respirat√≥ria (prov√°vel)';
      } else if (alcalemia) {
        prim = (hco3 > 26) ? 'Alcalose metab√≥lica (prov√°vel)' : 'Alcalose respirat√≥ria (prov√°vel)';
      } else {
        prim = 'pH normal/compensado (avaliar dist√∫rbios mistos)';
      }

      // Compensa√ß√µes (f√≥rmulas cl√°ssicas; cuidado pedi√°trico/ventila√ß√£o)
      let comp = '';
      if (hco3 < 22) {
        // Winter: pCO2 esperada = 1.5*HCO3 + 8 (¬±2)
        const exp = 1.5 * hco3 + 8;
        comp = `Compensa√ß√£o (Winter): pCO2 esperada ~ ${exp.toFixed(1)} mmHg (¬±2)`;
      } else if (hco3 > 26) {
        const exp = 0.7 * (hco3 - 24) + 40;
        comp = `Compensa√ß√£o alcalose metab√≥lica: pCO2 esperada ~ ${exp.toFixed(1)} mmHg (¬±5)`;
      } else {
        comp = 'Compensa√ß√£o: avaliar no contexto cl√≠nico (placeholder).';
      }

      let conduta =
        `Conduta (orientativa):\n` +
        `‚Ä¢ Correlacionar com cl√≠nica, lactato/cetonas/sepse/choque/IRA\n` +
        `‚Ä¢ Se acidose metab√≥lica com AG alto: pensar em lactato/cetoacidose/uremia/tox.\n` +
        `‚Ä¢ Se AG normal (hiperclor√™mica): pensar em diarreia/ATR/expans√£o com SF\n` +
        `‚Ä¢ Ajustar ventila√ß√£o apenas se indicado (evitar hiperventila√ß√£o iatrog√™nica)\n\n` +
        `ATUALIZAR: adicionar fluxos de conduta por diagn√≥stico institucional.`;

      const out =
        `${prim}\n\n` +
        `pH: ${ph.toFixed(2)} | pCO2: ${pco2.toFixed(1)} | HCO3-: ${hco3.toFixed(1)}\n` +
        `${agMsg}\n\n` +
        `${comp}\n\n` +
        `${conduta}`;

      showResult('res-gaso', out);
    }

    function convertLab() {
      const fator = Number(document.getElementById('lab-conv').value);
      const val = Number(document.getElementById('lab-val').value);
      if (!Number.isFinite(val)) return showResult('res-lab', 'Informe o valor para converter.');

      const res = val * fator;
      showResult('res-lab', `Resultado: ${res.toFixed(2)}`);
    }

    // =========================
    // CHECKLIST (placeholder)
    // =========================
    function renderCheck() {
      const idade = document.getElementById('ck-idade').value;
      const area = document.getElementById('check-area');
      if (!idade) { area.innerHTML = ''; return; }

      // Placeholder m√≠nimo (voc√™ pode substituir por checklists completos)
      const itens = {
        '2': ['Vacinas do 2¬∫ m√™s', 'Aleitamento materno', 'Triagem auditiva/olhinho (se pendente)'],
        '6': ['Introdu√ß√£o alimentar', 'Vacinas do 6¬∫ m√™s', 'Avaliar marcos do desenvolvimento'],
        '12': ['Vacinas 12 meses', 'Triagem anemia/ferro (conforme risco)', 'Avaliar linguagem e marcha']
      };

      const list = (itens[idade] || []).map(i => `<li>${i}</li>`).join('');
      area.innerHTML = `<div class="result-box" style="display:block"><span class="destaque">Checklist (placeholder)</span><ul style="margin:10px 0 0 18px">${list}</ul></div>`;
    }
  </script>
</body>
</html>
